{"ast":null,"code":"import _slicedToArray from \"@babel/runtime/helpers/slicedToArray\";\nimport ActivityIndicator from \"react-native-web/dist/exports/ActivityIndicator\";\nimport ImageBackground from \"react-native-web/dist/exports/ImageBackground\";\nimport StyleSheet from \"react-native-web/dist/exports/StyleSheet\";\nimport Text from \"react-native-web/dist/exports/Text\";\nimport View from \"react-native-web/dist/exports/View\";\nimport React, { useState, useContext, useEffect } from \"react\";\nimport Topbar from \"../components/Topbar\";\nimport BottomBar from \"../components/BottomBar\";\nimport { deleteDoc, doc, onSnapshot, setDoc, query, collection, where } from \"firebase/firestore\";\nimport { UserContext } from \"../UserContext\";\nimport { db } from \"../firebase\";\nimport { GameContext } from \"../GameContext\";\nimport { jsx as _jsx } from \"react/jsx-runtime\";\nimport { jsxs as _jsxs } from \"react/jsx-runtime\";\nvar id = Math.floor(Math.random() * Math.floor(Math.random() * Date.now()));\nconsole.log(\"ID: \", id);\n\nvar AddGame = function AddGame(_ref) {\n  var navigation = _ref.navigation;\n\n  var _useContext = useContext(UserContext),\n      user = _useContext.user,\n      setUser = _useContext.setUser;\n\n  var _useContext2 = useContext(GameContext),\n      game = _useContext2.game,\n      setGame = _useContext2.setGame;\n\n  var _useState = useState(_jsxs(View, {\n    style: styles.container,\n    children: [_jsx(Text, {\n      style: styles.text,\n      children: \"Adding game to queue\"\n    }), _jsx(ActivityIndicator, {\n      color: \"#ffff\",\n      size: \"large\"\n    })]\n  })),\n      _useState2 = _slicedToArray(_useState, 2),\n      bodyJSX = _useState2[0],\n      setBodyJSX = _useState2[1];\n\n  useEffect(function () {\n    setDoc(doc(db, \"games\", String(id)), {\n      id: String(id),\n      created: Date.now(),\n      finished: false,\n      started: false,\n      player1: user,\n      player2: null\n    }).then(function () {\n      console.log(\"Game added to database\");\n      setGame({\n        id: String(id),\n        created: Date.now(),\n        finished: false,\n        started: false,\n        player1: user,\n        player2: null\n      });\n    }).then(function () {\n      onSnapshot(doc(db, \"games\", String(id)), function (snapshot) {\n        setGame(snapshot.data());\n      });\n    }).catch(function (error) {\n      return console.log(error);\n    });\n  }, []);\n  useEffect(function () {\n    navigation.addListener(\"beforeRemove\", function (e) {\n      e.preventDefault();\n      deleteDoc(doc(db, \"games\", String(id)));\n    });\n  }, [navigation]);\n  useEffect(function () {\n    if (game != null) {\n      setBodyJSX(_jsxs(View, {\n        style: styles.container,\n        children: [_jsx(Text, {\n          style: styles.text,\n          children: \"Waiting for a player to join\"\n        }), _jsx(ActivityIndicator, {\n          color: \"#ffff\",\n          size: \"large\"\n        })]\n      }));\n\n      if (game[\"player2\"]) {\n        setBodyJSX(_jsx(View, {\n          style: styles.container,\n          children: _jsx(Text, {\n            style: styles.text,\n            children: \"Player found!\"\n          })\n        }));\n        navigation.navigate(\"multiplayerBattle\");\n      }\n    }\n  }, [game]);\n  return _jsx(View, {\n    children: _jsxs(ImageBackground, {\n      source: require(\"../assets/background.png\"),\n      style: styles.bg,\n      children: [_jsx(Topbar, {}), _jsx(BottomBar, {}), bodyJSX]\n    })\n  });\n};\n\nexport default AddGame;\nvar styles = StyleSheet.create({\n  bg: {\n    width: \"100%\",\n    height: \"100%\",\n    resizeMode: \"contain\",\n    display: \"flex\"\n  },\n  banner: {\n    marginTop: 50,\n    backgroundColor: \"#DD4141\",\n    width: \"100%\"\n  },\n  bannerText: {\n    fontSize: 40,\n    fontFamily: \"RetroGaming\",\n    color: \"white\",\n    textAlign: \"center\"\n  },\n  text: {\n    fontSize: 25,\n    textAlign: \"center\",\n    width: \"100%\",\n    color: \"white\",\n    fontFamily: \"RetroGaming\",\n    alignSelf: \"center\"\n  },\n  container: {\n    display: \"flex\",\n    alignItems: \"center\",\n    justifyContent: \"center\",\n    width: \"100%\",\n    height: \"100%\"\n  }\n});","map":{"version":3,"sources":["/home/aadivyaraushan/Documents/GitHub/nocrastination/screens/AddGame.js"],"names":["React","useState","useContext","useEffect","Topbar","BottomBar","deleteDoc","doc","onSnapshot","setDoc","query","collection","where","UserContext","db","GameContext","id","Math","floor","random","Date","now","console","log","AddGame","navigation","user","setUser","game","setGame","styles","container","text","bodyJSX","setBodyJSX","String","created","finished","started","player1","player2","then","snapshot","data","catch","error","addListener","e","preventDefault","navigate","require","bg","StyleSheet","create","width","height","resizeMode","display","banner","marginTop","backgroundColor","bannerText","fontSize","fontFamily","color","textAlign","alignSelf","alignItems","justifyContent"],"mappings":"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","sourcesContent":["import {\n  ActivityIndicator,\n  ImageBackground,\n  StyleSheet,\n  Text,\n  View,\n} from \"react-native\";\nimport React, { useState, useContext, useEffect } from \"react\";\nimport Topbar from \"../components/Topbar\";\nimport BottomBar from \"../components/BottomBar\";\nimport {\n  deleteDoc,\n  doc,\n  onSnapshot,\n  setDoc,\n  query,\n  collection,\n  where,\n} from \"firebase/firestore\";\nimport { UserContext } from \"../UserContext\";\nimport { db } from \"../firebase\";\nimport { GameContext } from \"../GameContext\";\n\nconst id = Math.floor(Math.random() * Math.floor(Math.random() * Date.now()));\nconsole.log(\"ID: \", id);\n\nconst AddGame = ({ navigation }) => {\n  const { user, setUser } = useContext(UserContext);\n  const { game, setGame } = useContext(GameContext);\n\n  const [bodyJSX, setBodyJSX] = useState(\n    <View style={styles.container}>\n      <Text style={styles.text}>Adding game to queue</Text>\n      <ActivityIndicator color=\"#ffff\" size=\"large\" />\n    </View>\n  );\n\n  useEffect(() => {\n    setDoc(doc(db, \"games\", String(id)), {\n      id: String(id),\n      created: Date.now(),\n      finished: false,\n      started: false,\n      player1: user,\n      player2: null,\n    })\n      .then(() => {\n        console.log(\"Game added to database\");\n        setGame({\n          id: String(id),\n          created: Date.now(),\n          finished: false,\n          started: false,\n          player1: user,\n          player2: null,\n        });\n      })\n      .then(() => {\n        onSnapshot(doc(db, \"games\", String(id)), (snapshot) => {\n          setGame(snapshot.data());\n        });\n      })\n      .catch((error) => console.log(error));\n  }, []);\n\n  useEffect(() => {\n    navigation.addListener(\"beforeRemove\", (e) => {\n      e.preventDefault();\n      deleteDoc(doc(db, \"games\", String(id)));\n    });\n  }, [navigation]);\n\n  useEffect(() => {\n    if (game != null) {\n      setBodyJSX(\n        <View style={styles.container}>\n          <Text style={styles.text}>Waiting for a player to join</Text>\n          <ActivityIndicator color=\"#ffff\" size=\"large\" />\n        </View>\n      );\n      if (game[\"player2\"]) {\n        setBodyJSX(\n          <View style={styles.container}>\n            <Text style={styles.text}>Player found!</Text>\n          </View>\n        );\n        navigation.navigate(\"multiplayerBattle\");\n      }\n    }\n  }, [game]);\n\n  return (\n    <View>\n      <ImageBackground\n        source={require(\"../assets/background.png\")}\n        style={styles.bg}\n      >\n        <Topbar />\n        <BottomBar />\n        {bodyJSX}\n      </ImageBackground>\n    </View>\n  );\n};\n\nexport default AddGame;\n\nconst styles = StyleSheet.create({\n  bg: {\n    width: \"100%\",\n    height: \"100%\",\n    resizeMode: \"contain\",\n    display: \"flex\",\n  },\n  banner: {\n    marginTop: 50,\n    backgroundColor: \"#DD4141\",\n    width: \"100%\",\n  },\n  bannerText: {\n    fontSize: 40,\n    fontFamily: \"RetroGaming\",\n    color: \"white\",\n    textAlign: \"center\",\n  },\n  text: {\n    fontSize: 25,\n    textAlign: \"center\",\n    width: \"100%\",\n    color: \"white\",\n    fontFamily: \"RetroGaming\",\n    alignSelf: \"center\",\n  },\n  container: {\n    display: \"flex\",\n    alignItems: \"center\",\n    justifyContent: \"center\",\n    width: \"100%\",\n    height: \"100%\",\n  },\n});\n"]},"metadata":{},"sourceType":"module"}